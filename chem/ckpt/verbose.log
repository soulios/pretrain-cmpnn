Fold 0
Loading data
Number of tasks = 7
Splitting data with seed 0
Class sizes
AR 0: 82.11%, 1: 17.89%
ER 0: 76.06%, 1: 23.94%
GR 0: 90.07%, 1: 9.93%
Aromatase 0: 88.67%, 1: 11.33%
TR 0: 93.06%, 1: 6.94%
PPARg 0: 89.44%, 1: 10.56%
ED 0: 69.43%, 1: 30.57%
Total size = 7,248 | train size = 5,798 | val size = 725 | test size = 725
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=7, bias=True)
  )
)
Number of parameters = 2,024,707
Moving model to cuda
Epoch 0
Fold 0
Loading data
Number of tasks = 7
Splitting data with seed 0
Class sizes
AR 0: 82.11%, 1: 17.89%
ER 0: 76.06%, 1: 23.94%
GR 0: 90.07%, 1: 9.93%
Aromatase 0: 88.67%, 1: 11.33%
TR 0: 93.06%, 1: 6.94%
PPARg 0: 89.44%, 1: 10.56%
ED 0: 69.43%, 1: 30.57%
Total size = 7,248 | train size = 5,798 | val size = 725 | test size = 725
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=7, bias=True)
  )
)
Number of parameters = 2,024,707
Moving model to cuda
Epoch 0
Fold 0
Loading data
Number of tasks = 7
Splitting data with seed 0
Class sizes
AR 0: 82.11%, 1: 17.89%
ER 0: 76.06%, 1: 23.94%
GR 0: 90.07%, 1: 9.93%
Aromatase 0: 88.67%, 1: 11.33%
TR 0: 93.06%, 1: 6.94%
PPARg 0: 89.44%, 1: 10.56%
ED 0: 69.43%, 1: 30.57%
Total size = 7,248 | train size = 5,798 | val size = 725 | test size = 725
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=7, bias=True)
  )
)
Number of parameters = 2,024,707
Moving model to cuda
Epoch 0
Fold 0
Loading data
Number of tasks = 7
Splitting data with seed 0
Class sizes
AR 0: 82.11%, 1: 17.89%
ER 0: 76.06%, 1: 23.94%
GR 0: 90.07%, 1: 9.93%
Aromatase 0: 88.67%, 1: 11.33%
TR 0: 93.06%, 1: 6.94%
PPARg 0: 89.44%, 1: 10.56%
ED 0: 69.43%, 1: 30.57%
Total size = 7,248 | train size = 5,798 | val size = 725 | test size = 725
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=7, bias=True)
  )
)
Number of parameters = 2,024,707
Moving model to cuda
Epoch 0
Validation auc = 0.799844
Model 0 best validation auc = 0.799844 on epoch 0
Moving model to cuda
Model 0 test auc = 0.815972
Ensemble test auc = 0.815972
Fold 1
Loading data
Number of tasks = 7
Splitting data with seed 1
Class sizes
AR 0: 82.11%, 1: 17.89%
ER 0: 76.06%, 1: 23.94%
GR 0: 90.07%, 1: 9.93%
Aromatase 0: 88.67%, 1: 11.33%
TR 0: 93.06%, 1: 6.94%
PPARg 0: 89.44%, 1: 10.56%
ED 0: 69.43%, 1: 30.57%
Total size = 7,248 | train size = 5,798 | val size = 725 | test size = 725
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=7, bias=True)
  )
)
Number of parameters = 2,024,707
Moving model to cuda
Epoch 0
Fold 0
Loading data
Number of tasks = 7
Splitting data with seed 0
Class sizes
AR 0: 82.11%, 1: 17.89%
ER 0: 76.06%, 1: 23.94%
GR 0: 90.07%, 1: 9.93%
Aromatase 0: 88.67%, 1: 11.33%
TR 0: 93.06%, 1: 6.94%
PPARg 0: 89.44%, 1: 10.56%
ED 0: 69.43%, 1: 30.57%
Total size = 7,248 | train size = 5,798 | val size = 725 | test size = 725
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=7, bias=True)
  )
)
Number of parameters = 2,024,707
Moving model to cuda
Epoch 0
